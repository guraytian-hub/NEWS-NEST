<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NewsNest | All-Time Ranking</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&family=Roboto&display=swap" rel="stylesheet">
<style>
body {
  font-family:'Roboto',sans-serif;
  margin:0;
  background:#FAF5F0;
  color:#333;
  overflow-x:hidden;
  position:relative;
}

header {
  background:#6DD3CE;
  color:#fff;
  text-align:center;
  padding:1.5rem;
  font-family:'Poppins',sans-serif;
  font-size:2.5rem;
  letter-spacing:1px;
  position:relative;
  z-index:2;
}

nav {
  display:flex;
  justify-content:center;
  gap:1rem;
  padding:1rem;
  background:#FF9A8B;
  flex-wrap:wrap;
  position:relative;
  z-index:2;
}

.nav-btn {
  background:#fff;
  color:#FF6B6B;
  border:none;
  padding:0.7rem 1.5rem;
  border-radius:12px;
  font-weight:600;
  cursor:pointer;
  text-decoration:none;
  transition:0.3s;
}
.nav-btn:hover {
  background:#FF6B6B;
  color:#fff;
}

main {
  max-width:1000px;
  margin:2rem auto;
  padding:0 1rem;
  position:relative;
  z-index:2;
}

/* News card */
.news-card {
  display:flex;
  flex-direction:row;
  background:#fff;
  padding:1.5rem;
  border-radius:12px;
  box-shadow:0 4px 10px rgba(0,0,0,0.08);
  margin-bottom:2rem;
  gap:1rem;
  position:relative;
}

.news-card img {
  width:260px;
  height:160px;
  object-fit:cover;
  border-radius:12px;
}

.news-content h3 {
  font-family:'Poppins',sans-serif;
  color:#333;
  margin-bottom:0.5rem;
  font-size:1.4rem;
}

.news-content .news-author,
.news-content .news-views,
.news-content .news-date {
  font-size:0.9rem;
  font-style:italic;
  color:#555;
  margin-bottom:0.3rem;
}

.news-content .news-category {
  font-size:0.9rem;
  font-weight:600;
  color:#FF6F61;
  margin-bottom:0.5rem;
}

.news-content p {
  margin-bottom:0.5rem;
  font-size:1rem;
  color:#444;
}

/* Ranking badges */
.rank-badge {
  position:absolute;
  top:10px;
  left:10px;
  background:#6DD3CE;
  color:#fff;
  font-weight:700;
  padding:0.4rem 0.8rem;
  border-radius:50px;
  font-size:0.9rem;
}
.rank-1 { background:#FFD700; color:#333; }
.rank-2 { background:#C0C0C0; color:#333; }
.rank-3 { background:#CD7F32; color:#fff; }

.prize-badge {
  margin-top:0.5rem;
  font-size:0.9rem;
  font-weight:600;
}

/* Likes button */
.likes-btn {
  background:#6DD3CE;
  color:#fff;
  border:none;
  padding:0.5rem 1rem;
  border-radius:8px;
  cursor:pointer;
  font-weight:600;
  margin-top:0.5rem;
  transition:0.3s;
}
.likes-btn:hover {
  background:#4BA6A0;
}

.likes-info {
  margin-top:0.4rem;
  font-size:0.9rem;
  color:#444;
  font-weight:500;
}

.likes-info strong {
  color:#FF6B6B;
}

/* Progress bar for percentages */
.progress {
  width:100%;
  height:10px;
  background:#eee;
  border-radius:5px;
  overflow:hidden;
  margin-top:0.3rem;
}
.progress-fill {
  height:100%;
  background:#6DD3CE;
  transition:width 0.5s;
}

footer {
  text-align:center;
  padding:1rem;
  background:#6DD3CE;
  color:#fff;
  margin-top:2rem;
  font-size:0.9rem;
}

@media(max-width:768px){
  .news-card{flex-direction:column;}
  .news-card img{width:100%; height:auto;}
}

/* --- Floating bubbles --- */
.bubble {
  position:absolute;
  border-radius:50%;
  opacity:0.2;
  pointer-events:none;
  animation: drift linear infinite;
}
@keyframes drift {
  0% { transform: translate(0,0) rotate(0deg); }
  50% { transform: translate(50vw,-30vh) rotate(180deg); }
  100% { transform: translate(-50vw,-100vh) rotate(360deg); }
}
</style>
</head>
<body>

<header>NewsNest All-Time Ranking</header>

<nav>
<a href="home.html" class="nav-btn">Home</a>
<a href="explore.html" class="nav-btn">Explore</a>
<a href="search.html" class="nav-btn">Search</a>
<a href="CreateNews.html" class="nav-btn">Create News</a>
<a href="ranking.html" class="nav-btn">Ranking</a>
<a href="weekly-award.html" class="nav-btn">Weekly Contest</a>
<a href="login.html" class="nav-btn">Login</a>
</nav>

<main>
<section id="ranking-news"></section>
</main>

<footer>&copy; 2025 NewsNest | All Readers Are Authors</footer>

<script>
const rankingContainer = document.getElementById('ranking-news');

// Format likes (1.2k, 3.5M, etc.)
function formatLikes(num){
  if(num>=1e12) return (num/1e12).toFixed(1)+'T';
  if(num>=1e9) return (num/1e9).toFixed(1)+'B';
  if(num>=1e6) return (num/1e6).toFixed(1)+'M';
  if(num>=1e3) return (num/1e3).toFixed(1)+'k';
  return num;
}

// Load and sort news by likes
function loadRankingNews(){
  rankingContainer.innerHTML='';
  let allNews = JSON.parse(localStorage.getItem('newsNestArticles')||'[]');
  if(allNews.length===0){ 
    rankingContainer.innerHTML='<p style="text-align:center">No news yet! Create some news first.</p>'; 
    return; 
  }

  // total likes
  const totalLikes = allNews.reduce((sum,n)=>sum+(n.likes||0),0) || 1;

  allNews.sort((a,b)=>b.likes - a.likes);
  allNews.forEach((n,i)=>createNewsCard(n, i+1, totalLikes, rankingContainer));
}

// Create card
function createNewsCard(news, rank, totalLikes, container){
  const likes = news.likes || 0;
  const percent = ((likes/totalLikes)*100).toFixed(1);

  const card=document.createElement('div');
  card.className='news-card';
  card.innerHTML=`
    <span class="rank-badge rank-${rank}">${rank}</span>
    <img src="${news.image||'https://via.placeholder.com/260x160'}">
    <div class="news-content">
      <h3>${news.title}</h3>
      <div class="news-author">By ${news.author||'Unknown'}</div>
      <div class="news-category">Category: ${news.category||'N/A'}</div>
      <div class="news-date">Posted: ${news.date||'N/A'}</div>
      <div class="news-views">Views: ${news.views||0}</div>
      <p>${news.content}</p>
      <div class="prize-badge">
        ${rank===1?'üèÜ Most Liked':
          rank===2?'ü•à Second Most':
          rank===3?'ü•â Third Most':''}
      </div>
      <button class="likes-btn" onclick="likeNews(this,'${news.title}')">
        üëç <span data-raw="${likes}">${formatLikes(likes)}</span> Likes
      </button>
      <div class="likes-info">
        <strong>${percent}%</strong> of all likes 
        (${formatLikes(likes)} / ${formatLikes(totalLikes)})
      </div>
      <div class="progress">
        <div class="progress-fill" style="width:${percent}%"></div>
      </div>
    </div>
  `;
  container.appendChild(card);
}

// Like button
function likeNews(btn,title){
  let span=btn.querySelector('span');
  let likes=parseInt(span.getAttribute('data-raw'))+1;
  span.setAttribute('data-raw', likes);
  span.innerText=formatLikes(likes);

  let allNews=JSON.parse(localStorage.getItem('newsNestArticles')||'[]');
  allNews.forEach(n=>{
    if(n.title===title) n.likes=likes;
  });
  localStorage.setItem('newsNestArticles', JSON.stringify(allNews));
  loadRankingNews();
}

// Floating bubbles
function createBubbles(count){
  for(let i=0;i<count;i++){
    const bubble=document.createElement('div');
    bubble.className='bubble';
    bubble.style.width=(10+Math.random()*30)+'px';
    bubble.style.height=(10+Math.random()*30)+'px';
    bubble.style.background='hsla('+(Math.random()*360)+',70%,80%,0.3)';
    bubble.style.left=Math.random()*100+'vw';
    bubble.style.top=Math.random()*100+'vh';
    bubble.style.animationDuration=(10+Math.random()*20)+'s';
    document.body.appendChild(bubble);
  }
}

window.onload=()=>{
  createBubbles(15);
  loadRankingNews();
};
</script>

</body>
</html>
